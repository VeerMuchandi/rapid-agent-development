{
  "title": "A2UI Message Schema",
  "description": "Describes a JSON payload for an A2UI (Agent to UI) message, which is used to dynamically construct and update user interfaces. A message MUST contain exactly ONE of the action properties: 'beginRendering', 'surfaceUpdate', 'dataModelUpdate', or 'deleteSurface'.",
  "type": "object",
  "properties": {
    "beginRendering": {
      "type": "object",
      "description": "Signals the client to begin rendering a surface with a root component and specific styles.",
      "properties": {
        "surfaceId": {
          "type": "string",
          "description": "The unique identifier for the UI surface to be rendered."
        },
        "root": {
          "type": "string",
          "description": "The ID of the root component to render."
        },
        "styles": {
          "type": "object",
          "description": "Styling information for the UI.",
          "properties": {
            "font": {
              "type": "string",
              "description": "The primary font for the UI."
            },
            "primaryColor": {
              "type": "string",
              "description": "The primary UI color as a hexadecimal code (e.g., '#00BFFF').",
              "pattern": "^#[0-9a-fA-F]{6}$"
            }
          }
        }
      },
      "required": ["root", "surfaceId"]
    },
    "surfaceUpdate": {
      "type": "object",
      "description": "Updates a surface with a new set of components.",
      "properties": {
        "surfaceId": {
          "type": "string",
          "description": "The unique identifier for the UI surface to be updated."
        },
        "components": {
          "type": "array",
          "description": "A list containing all UI components for the surface.",
          "minItems": 1,
          "items": {
            "type": "object",
            "description": "Represents a *single* component in a UI widget tree.",
            "properties": {
              "id": {
                "type": "string",
                "description": "The unique identifier for this component."
              },
              "weight": {
                "type": "number",
                "description": "The relative weight of this component within a Row or Column."
              },
              "component": {
                "type": "object",
                "description": "Wrapper object containing exactly one component type key.",
                "properties": {
                  "Text": {
                    "type": "object",
                    "properties": {
                      "text": {
                        "type": "object",
                        "properties": {
                          "literalString": { "type": "string" },
                          "path": { "type": "string" }
                        }
                      },
                      "usageHint": {
                        "type": "string",
                        "enum": ["h1", "h2", "h3", "h4", "h5", "caption", "body"]
                      }
                    },
                    "required": ["text"]
                  },
                  "Image": {
                    "type": "object",
                    "properties": {
                      "url": {
                        "type": "object",
                        "properties": {
                          "literalString": { "type": "string" },
                          "path": { "type": "string" }
                        }
                      },
                      "fit": { "type": "string", "enum": ["contain", "cover", "fill", "none", "scale-down"] },
                      "usageHint": { "type": "string", "enum": ["icon", "avatar", "smallFeature", "mediumFeature", "largeFeature", "header"] }
                    },
                    "required": ["url"]
                  },
                  "Icon": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "object",
                        "properties": {
                          "literalString": { "type": "string" },
                          "path": { "type": "string" }
                        }
                      }
                    },
                    "required": ["name"]
                  },
                  "Video": {
                    "type": "object",
                    "properties": {
                      "url": { "type": "object", "properties": { "literalString": { "type": "string" }, "path": { "type": "string" } } }
                    },
                    "required": ["url"]
                  },
                  "AudioPlayer": {
                    "type": "object",
                    "properties": {
                      "url": { "type": "object", "properties": { "literalString": { "type": "string" }, "path": { "type": "string" } } },
                      "description": { "type": "object", "properties": { "literalString": { "type": "string" }, "path": { "type": "string" } } }
                    },
                    "required": ["url"]
                  },
                  "Row": {
                    "type": "object",
                    "properties": {
                      "children": {
                        "type": "object",
                        "properties": {
                          "explicitList": { "type": "array", "items": { "type": "string" } },
                          "template": {
                            "type": "object",
                            "required": ["componentId", "dataBinding"],
                            "properties": {
                              "componentId": { "type": "string" },
                              "dataBinding": { "type": "string" }
                            }
                          }
                        }
                      },
                      "distribution": { "type": "string", "enum": ["center", "end", "spaceAround", "spaceBetween", "spaceEvenly", "start"] },
                      "alignment": { "type": "string", "enum": ["start", "center", "end", "stretch"] }
                    },
                    "required": ["children"]
                  },
                  "Column": {
                    "type": "object",
                    "properties": {
                      "children": {
                        "type": "object",
                        "properties": {
                          "explicitList": { "type": "array", "items": { "type": "string" } },
                          "template": { "type": "object", "required": ["componentId", "dataBinding"] }
                        }
                      },
                      "distribution": { "type": "string", "enum": ["start", "center", "end", "spaceBetween", "spaceAround", "spaceEvenly"] },
                      "alignment": { "type": "string", "enum": ["center", "end", "start", "stretch"] }
                    },
                    "required": ["children"]
                  },
                  "List": {
                    "type": "object",
                    "properties": {
                      "children": {
                        "type": "object",
                        "properties": {
                          "explicitList": { "type": "array", "items": { "type": "string" } },
                          "template": { "type": "object", "required": ["componentId", "dataBinding"] }
                        }
                      },
                      "direction": { "type": "string", "enum": ["vertical", "horizontal"] },
                      "alignment": { "type": "string", "enum": ["start", "center", "end", "stretch"] }
                    },
                    "required": ["children"]
                  },
                  "Card": {
                    "type": "object",
                    "properties": {
                      "child": { "type": "string" }
                    },
                    "required": ["child"]
                  },
                  "Tabs": {
                    "type": "object",
                    "properties": {
                      "tabItems": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "title": { "type": "object", "properties": { "literalString": { "type": "string" }, "path": { "type": "string" } } },
                            "child": { "type": "string" }
                          },
                          "required": ["title", "child"]
                        }
                      }
                    },
                    "required": ["tabItems"]
                  },
                  "Divider": {
                    "type": "object",
                    "properties": {
                      "axis": { "type": "string", "enum": ["horizontal", "vertical"] }
                    }
                  },
                  "Modal": {
                    "type": "object",
                    "properties": {
                      "entryPointChild": { "type": "string" },
                      "contentChild": { "type": "string" }
                    },
                    "required": ["entryPointChild", "contentChild"]
                  },
                  "Button": {
                    "type": "object",
                    "properties": {
                      "child": { "type": "string" },
                      "primary": { "type": "boolean" },
                      "action": {
                        "type": "object",
                        "properties": {
                          "name": { "type": "string" },
                          "context": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "key": { "type": "string" },
                                "value": {
                                  "type": "object",
                                  "properties": {
                                    "path": { "type": "string" },
                                    "literalString": { "type": "string" },
                                    "literalNumber": { "type": "number" },
                                    "literalBoolean": { "type": "boolean" }
                                  }
                                }
                              },
                              "required": ["key", "value"]
                            }
                          }
                        },
                        "required": ["name"]
                      }
                    },
                    "required": ["child", "action"]
                  },
                  "CheckBox": {
                    "type": "object",
                    "properties": {
                      "label": { "type": "object", "properties": { "literalString": { "type": "string" }, "path": { "type": "string" } } },
                      "value": { "type": "object", "properties": { "literalBoolean": { "type": "boolean" }, "path": { "type": "string" } } }
                    },
                    "required": ["label", "value"]
                  },
                  "TextField": {
                    "type": "object",
                    "properties": {
                      "label": { "type": "object", "properties": { "literalString": { "type": "string" }, "path": { "type": "string" } } },
                      "text": { "type": "object", "properties": { "literalString": { "type": "string" }, "path": { "type": "string" } } },
                      "textFieldType": { "type": "string", "enum": ["date", "longText", "number", "shortText", "obscured"] },
                      "validationRegexp": { "type": "string" }
                    },
                    "required": ["label"]
                  },
                  "DateTimeInput": {
                     "type": "object",
                     "properties": {
                       "value": { "type": "object", "properties": { "literalString": { "type": "string" }, "path": { "type": "string" } } },
                       "enableDate": { "type": "boolean" },
                       "enableTime": { "type": "boolean" }
                     },
                     "required": ["value"]
                  },
                  "MultipleChoice": {
                    "type": "object",
                    "properties": {
                      "selections": { "type": "object", "properties": { "literalArray": { "items": { "type": "string" } }, "path": { "type": "string" } } },
                      "options": {
                         "type": "array",
                         "items": {
                           "type": "object",
                           "properties": {
                             "label": { "type": "object", "properties": { "literalString": { "type": "string" }, "path": { "type": "string" } } },
                             "value": { "type": "string" }
                           },
                           "required": ["label", "value"]
                         }
                      },
                      "maxAllowedSelections": { "type": "integer" }
                    },
                    "required": ["selections", "options"]
                  },
                  "Slider": {
                    "type": "object",
                    "properties": {
                      "value": { "type": "object", "properties": { "literalNumber": { "type": "number" }, "path": { "type": "string" } } },
                      "minValue": { "type": "number" },
                      "maxValue": { "type": "number" }
                    },
                    "required": ["value"]
                  }
                }
              }
            },
            "required": ["id", "component"]
          }
        }
      },
      "required": ["surfaceId", "components"]
    },
    "dataModelUpdate": {
      "type": "object",
      "properties": {
        "surfaceId": { "type": "string" },
        "path": { "type": "string" },
        "contents": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "key": { "type": "string" },
              "valueString": { "type": "string" },
              "valueNumber": { "type": "number" },
              "valueBoolean": { "type": "boolean" },
              "valueMap": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "key": { "type": "string" },
                    "valueString": { "type": "string" },
                    "valueNumber": { "type": "number" },
                    "valueBoolean": { "type": "boolean" }
                  },
                  "required": ["key"]
                }
              },
              "valueList": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "valueString": { "type": "string" },
                    "valueNumber": { "type": "number" },
                    "valueBoolean": { "type": "boolean" },
                    "valueMap": {
                      "type": "array",
                      "items": { "type": "object", "properties": { "key": { "type": "string" } } }
                    },
                    "valueList": { "type": "array", "items": { "type": "object" } }
                  }
                }
              },
              "valueArray": { "type": "array", "items": { "type": "object" } }
            },
            "required": ["key"]
          }
        }
      },
      "required": ["contents", "surfaceId"]
    },
    "deleteSurface": {
      "type": "object",
      "properties": {
        "surfaceId": { "type": "string" }
      },
      "required": ["surfaceId"]
    }
  }
}
